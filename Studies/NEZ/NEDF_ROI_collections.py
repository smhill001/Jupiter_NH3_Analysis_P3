def NEDF_ROI_collections(collection="20241202-20241202 NEDF 340",writecatalog=False):

    import sys
    import json
    import csv
    drive='c:'
    sys.path.append(drive+'/Astronomy/Python Play')
    sys.path.append(drive+'/Astronomy/Python Play/Util_P3')
    sys.path.append(drive+'/Astronomy/Python Play/SpectroPhotometry/Spectroscopy')
    sys.path.append('./Services')
    
    ###########################################################################
    # GRAB OBSERVATIONS (KEY) LISTS AND THEN SET ROI BOUNDARIES  AND CM
    # SEQUENCE IF NEEDED TO TRACK A DRIFING TARGET (SYS I)
    ###########################################################################
    nedf_collections = {
    "20230827-20240301 NEDF": {
        "ROI": {
            "NEDF1": [80, 83, 207.0, 2.0],
            "Fest1": [85, 88, 215.0, 2.0],
            "Plume1": [85, 88, 207.0, 2.0],
            " +NH3": [84, 89, 210, 10.0],
            " -NH3": [84, 89, 185, 10.0],
            "STrZ Ref": [91, 93, 200.0, 3.0]
        },
        "obskeys": [
            "20230827UTa", "20230905UTa", "20230922UTa",
            "20230929UTa", "20231006UTa"
        ],
        "CM": [200]
    },
    "20241115-20241115": {
        "ROI": {
            "CORE": [91, 93, 200.0, 2.0],
            "NE Plume": [91, 93, 200.0, 2.0],
            "SW Plume": [91, 93, 200.0, 2.0],
            "SEB Ref1": [91, 93, 200, 2.0],
            "SEB Ref2": [91, 93, 200, 2.0],
            "STrZ Ref": [91, 93, 200.0, 3.0]
        },
        "obskeys": [
            "20241115UTa", "20241115UTb", "20241115UTc",
            "20241115UTd", "20241115UTe"
        ],
        "CM": [200]
    },
    "20241129-20241129 NEDF 235": {
        "ROI": {
            "NEDF1": [80, 82, 237.0, 2.0],
            "Plume1": [83, 85, 229.0, 2.0],
            " +NH3": [85, 88, 236, 2.0],
            "NEB Ref": [75, 77, 232, 8.0]
        },
        "obskeys": [
            "20241129UTc", "20241129UTd", "20241129UTe",
            "20241129UTf", "20241129UTg"
        ],
        "CM": [235]
    },
    "20241129-20241129 NEDF 280": {
        "ROI": {
            "NEDF1": [80, 83, 282.0, 2.0],
            "Fest1": [84, 87, 288.0, 2.0],
            "Fest2": [92, 94, 288.0, 2.0],
            "Plume1": [83, 85, 274.0, 2.0],
            " +NH3": [84, 87, 279, 2.0],
            "NEB Ref": [75, 77, 277, 8.0]
        },
        "obskeys": [
            "20241129UTg", "20241129UTh", "20241129UTi",
            "20241129UTj", "20241129UTk", "20241129UTl",
            "20241129UTm"
        ],
        "CM": [280]
    },
    "20241129-20241129 NEDF 322": {
        "ROI": {
            "NEDF1": [80, 83, 327.0, 2.0],
            "Fest1": [84, 87, 333.0, 2.0],
            "Fest2": [92, 94, 333.0, 2.0],
            "Plume1": [83, 85, 319.0, 2.0],
            " +NH3": [84, 87, 324, 2.0],
            "NEB Ref": [75, 77, 322, 8.0]
        },
        "obskeys": [
            "20241129UTj", "20241129UTk", "20241129UTl",
            "20241129UTm", "20241129UTn"
        ],
        "CM": [322]
    },
    "20241129-20241129 NEDF 340": {
        "ROI": {
            "NEDF1": [80, 83, 345.0, 2.0],
            "Fest1": [84, 87, 352.0, 2.0],
            "Fest2": [92, 94, 352.0, 2.0],
            "Plume1": [83, 85, 337.0, 2.0],
            " +NH3": [84, 87, 342, 2.0],
            "NEB Ref": [75, 77, 340, 8.0]
        },
        "obskeys": [
            "20241129UTm", "20241129UTn", "20241129UTo",
            "20241129UTp"
        ],
        "CM": [340]
    },
    "20241202-20241202 NEDF 235": {
        "ROI": {
            "NEDF1": [80, 82, 237.0, 2.0],
            "Fest1": [82, 84, 243.0, 2.0],
            "Fest2": [92, 94, 243.0, 2.0],
            "Plume1": [83, 85, 229.0, 2.0],
            " +NH3": [85, 88, 236, 2.0],
            "NEB Ref": [75, 77, 232, 8.0]
        },
        "obskeys": ["20241202UTa", "20241202UTb", "20241202UTc"],
        "CM": [235]
    },
    "20241202-20241202 NEDF 280": {
        "ROI": {
            "NEDF1": [80, 83, 282.0, 2.0],
            "Fest1": [84, 87, 288.0, 2.0],
            "Fest2": [92, 94, 288.0, 2.0],
            "Plume1": [83, 85, 274.0, 2.0],
            " +NH3": [84, 87, 279, 2.0],
            "NEB Ref": [75, 77, 277, 8.0]
        },
        "obskeys": [
            "20241202UTa", "20241202UTb", "20241202UTc",
            "20241202UTd", "20241202UTe", "20241202UTf"
        ],
        "CM": [280]
    },
    "20241202-20241202 NEDF 322": {
        "ROI": {
            "NEDF1": [80, 83, 327.0, 2.0],
            "Fest1": [84, 87, 333.0, 2.0],
            "Fest2": [92, 94, 333.0, 2.0],
            "Plume1": [83, 85, 319.0, 2.0],
            " +NH3": [84, 87, 324, 2.0],
            "NEB Ref": [75, 77, 322, 8.0]
        },
        "obskeys": ["20241202UTd", "20241202UTe", "20241202UTf", "20241202UTg"],
        "CM": [322]
    },
    "20241202-20241202 NEDF 340": {
        "ROI": {
            "NEDF1": [80, 83, 353.0, 2.0],
            "Fest1": [84, 87, 357.0, 2.0],
            "Fest2": [92, 94, 353.0, 2.0],
            "Plume1": [82, 84, 341.0, 2.0],
            " +NH3": [84, 87, 351, 2.0],
            "NEB Ref": [75, 77, 347, 8.0]
        },
        "obskeys": ["20241202UTe", "20241202UTf", "20241202UTg", "20241202UTh"],
        "CM": [340]
    },
    "20241105-20241105 NEDF A": {
        "ROI": {
            "NEDF1": [80, 83, 25.0, 2.0],
            "Plume1": [82, 84, 15.0, 2.0],
            " +NH3": [84, 87, 25, 7.0],
            "NEB Ref": [75, 77, 27, 8.0]
        },
        "obskeys": [
            "20241105UTa", "20241105UTb", "20241105UTc",
            "20241105UTd", "20241105UTe"
        ],
        "CM": [25]
    },
    "20241118-20241118 NEDF A": {
        "ROI": {
            "NEDF1": [79, 82, 35.0, 2.0],
            "Plume1": [83, 85, 21.0, 2.0],
            " +NH3": [83, 86, 29, 3.0],
            "NEB Ref": [75, 77, 29, 8.0]
        },
        "obskeys": [
            "20241118UTl", "20241118UTm", "20241118UTn",
            "20241118UTo", "20241118UTp"
        ],
        "CM": [30]
    },
    "20241128-20241128 NEDF A": {
        "ROI": {
            "NEDF1": [78, 81, 43.0, 2.0],
            "Plume1": [85, 87, 29.0, 2.0],
            " +NH3": [82, 85, 36, 3.0],
            "NEB Ref": [75, 77, 35, 8.0]
        },
        "obskeys": [
            "20241128UTa", "20241128UTb", "20241128UTc",
            "20241128UTd", "20241128UTe", "20241128UTf"
        ],
        "CM": [35]
    },
    "20241203-20241203 NEDF A": {
        "ROI": {
            "NEDF1": [79, 82, 41.0, 2.0],
            "Plume1": [82, 84, 21.0, 2.0],
            " +NH3": [82, 85, 32, 3.0],
            "NEB Ref": [75, 77, 35, 8.0]
        },
        "obskeys": [
            "20241203UTa", "20241203UTb",
            "20241203UTc", "20241203UTd"
        ],
        "CM": [30]
    },
    "20241205-20241205 NEDF A": {
        "ROI": {
            "NEDF1": [80, 83, 42.0, 2.0],
            "Plume1": [81, 84, 16.0, 2.0],
            " +NH3": [83, 86, 32, 3.0],
            "NEB Ref": [75, 77, 35, 8.0]
        },
        "obskeys": [
            "20241205UTc", "20241205UTd", "20241205UTe",
            "20241205UTf", "20241205UTg"
        ],
        "CM": [30]
    },
    "20250106-20250106 NEDF CD": {
        "ROI": {
            "NEDF C": [80, 83, 145.0, 2.0],
            "Plume C": [83, 86, 135.0, 4.0],
            " +NH3 C": [85, 88, 144, 3.0],
            "NEDF D": [80, 84, 176.0, 2.0],
            "Plume D": [82, 86, 165.0, 3.0],
            " +NH3 D": [84, 88, 173, 3.0],
            "NEB Ref": [75, 77, 155, 10.0]
        },
        "obskeys": [
            "20250106UTq", "20250106UTr", "20250106UTs"
        ],
        "CM": [155]
    },
    
    "20241128-20241128 SED": {
        "ROI": {
            "SED C": [94, 98, 68.0, 2.0],
            "HS1 C": [90, 94, 59.0, 2.0],
            "NEB Ref": [75, 77, 60, 10.0],
            "Plume C": [82, 84, 72.0, 4.0],
            " +NH3 C": [84, 88, 81, 3.0],
            " +NH3 D": [83, 87, 35, 3.0],
            "NEDF C": [81, 83, 42.0, 2.0]


        },
        "obskeys": [
            "20241128UTc", "20241128UTd", "20241128UTe", "20241128UTf", "20241128UTg"
        ],
        "CM": [60]
    },
    
    "20241203-20241203 SED": {
        "ROI": {
            "SED C": [94, 98, 71.0, 2.0],
            "HS1 C": [90, 94, 63.0, 2.0],
            "NEB Ref": [75, 77, 60, 10.0],
            "Plume C": [82, 84, 74.0, 4.0],
            " +NH3 C": [84, 88, 83, 3.0],
            " +NH3 D": [83, 87, 35, 3.0],
            "NEDF C": [81, 83, 42.0, 2.0]

        },
        "obskeys": [
            "20241203UTa", "20241203UTb", "20241203UTc", "20241203UTd", "20241203UTe"
        ],
        "CM": [60]
    },
    
    "20241205-20241205 SED": {
        "ROI": {
            "SED C": [94, 98, 74.0, 2.0],
            "HS1 C": [91, 95, 63.0, 2.0],
            "NEB Ref": [75, 77, 60, 10.0],
            "Plume C": [83, 85, 76.0, 4.0],
            " +NH3 C": [83, 87, 85, 3.0],
            " +NH3 D": [83, 87, 34, 3.0],
            "NEDF C": [80, 82, 41.0, 2.0]

        },
        "obskeys": [
            "20241205UTd", "20241205UTe", "20241205UTf", "20241205UTg", "20241205UTh"
        ],
        "CM": [60]
    }
}
        
    ###########################################################################
    # SEB Collections
    ###########################################################################
        
    if collection=="20241115-20241115 SEB OB":
        ROI={"CORE":[103,106,324.0,2.0],
             "NE Plume":[99,102,320.0,2.0],
             "SW Plume":[105,108,329.0,2.0],
             "SEB Ref1":[102,104,334,2.0],
             "SEB Ref2":[100,108,311,2.0],
             "STrZ Ref":[111,115,323.0,3.0]}     
        obskeys=["20241115UTa","20241115UTb","20241115UTc","20241115UTd","20241115UTe"]
        CM=[322]

    if collection=="20241129-20241129 SEB OB":
        ROI={"CORE":[102,105,323.0,2.0],
             "NE Plume":[98,101,320.0,2.0],
             "SW Plume":[104,107,329.0,2.0],
             "SEB Ref1":[102,104,334,2.0],
             "SEB Ref2":[105,108,313,3.0],
             "STrZ Ref":[111,113,323.0,5.0]}
        obskeys=["20241129UTg","20241129UTh","20241129UTi",
                 "20241129UTj","20241129UTk","20241129UTl","20241129UTm"]
        CM=[322]
    
    if collection=="20241202-20241202 SEB OB":
        ROI={"CORE":[102,105,326.0,2.0],
             "NE Plume":[101,104,318.0,2.0],
             "SW Plume":[106,109,333.0,2.0],
             "SEB Ref1":[102,104,336,2.0],
             "SEB Ref2":[105,108,313,3.0],
             "STrZ Ref":[111,113,326.0,5.0]}
        obskeys=["20241202UTc","20241202UTd","20241202UTe","20241202UTf",
                 "20241202UTg","20241202UTh"]
        CM=[325]
        
    if writecatalog:
        outpath="C:/Astronomy/Projects/SAS 2021 Ammonia/Jupiter_NH3_Analysis_P3/Studies/NEZ/"
        # Write JSON
        with open(outpath+"roi_collections.json", "w") as jf:
            json.dump(nedf_collections, jf, indent=4)
        
        # Write CSV
        with open(outpath+"nedf_collections.csv", "w", newline="") as cf:
            writer = csv.writer(cf)
            writer.writerow(["Collection", "ROI Name", "Start Colat", "End Colat", "Lon", "Width", "Obskeys", "CM"])
            for collection, data in nedf_collections.items():
                obslist_str = ";".join(data["obskeys"])
                CM_str = ";".join(map(str, data["CM"]))
                for roi_name, roi_vals in data["ROI"].items():
                    writer.writerow([collection, roi_name, *roi_vals, obslist_str, CM_str])
   
    return(nedf_collections[collection]["ROI"],nedf_collections[collection]["obskeys"],nedf_collections[collection]["CM"])